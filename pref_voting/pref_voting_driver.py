from pref_voting_methods import create_profile, run_voting_methods
import os
import csv
import time
import multiprocessing

data_file = '/Users/belle/Desktop/build/rcv_proposal/pref_voting/processed_results/civs_results.csv'
root_dir = '/Users/belle/Desktop/build/rcv_proposal/civs'

error_file = '/Users/belle/Desktop/build/rcv_proposal/pref_voting/processed_results/supporting_files/civs_error.txt'
processed_file = '/Users/belle/Desktop/build/rcv_proposal/pref_voting/processed_results/supporting_files/civs_processed.txt'
all_data = []

processed = ["2460a21056.csv", "2d79140816.csv", "cbd4c8f99e.csv", "dc8e4b3d7e.csv", "03da1b092a.csv", "29b50de509.csv", "ad8b6669b7.csv", "daa64ea6ab.csv", "8c021a1d3f.csv", "275dc3a473.csv", "f54832957c.csv", "0428dd6721.csv", "006040facf.csv", "541011ac5f.csv", "c466c1defc.csv", "d7336a15d4.csv", "d2e7d355f7.csv", "2e2997bc63.csv", "01328a3ae9.csv", "616b90a1e3.csv", "dc253fca78.csv", "271eb9092b.csv", "9479d62c8f.csv", "17c08f5aed.csv", "324d040899.csv", "c6eb4b11b4.csv", "1d9cc095e6.csv", "7d80c0b27e.csv", "623c13d2c1.csv", "8af9726074.csv", "8960f63795.csv", "caf5812585.csv", "78abd93719.csv", "b1b8763c2a.csv", "42c16181ff.csv", "dd3a3b6636.csv", "48f62f99f7.csv", "d79155a77d.csv", "980e9d60a9.csv", "99f3c72f0f.csv", "465e39005e.csv", "62613bd959.csv", "3b92bd95b4.csv", "ef5903ac2b.csv", "385f5a652a.csv", "1a3300430c.csv", "ca5ced2540.csv", "21b60b3955.csv", "9570ed76e1.csv", "74fd45dbb6.csv", "6cf90b563a.csv", "b6c7863dc1.csv", "fc4915aaf7.csv", "dd7c798ddf.csv", "43719fca32.csv", "d424aa153c.csv", "abbf2caea5.csv", "488a267122.csv", "4cc0e805c8.csv", "25107c2852.csv", "43a1149aa5.csv", "ffbed5118f.csv", "e7dd0b0243.csv", "2746502843.csv", "02c2dcfdde.csv", "b8ba7dd30c.csv", "49afec44e6.csv", "da64f443c0.csv", "3eab6ce560.csv", "4b62e31ef9.csv", "0daaf83cb2.csv", "553b2eb052.csv", "42e9f6d629.csv", "f084df174f.csv", "3205c9aa08.csv", "a2c763a449.csv", "609c5caf54.csv", "0852f34d17.csv", "1c5bc1529d.csv", "277e60df7f.csv", "fc064eba99.csv", "079e3b8a8d.csv", "e44e6f9835.csv", "3c0a0d1465.csv", "b3d02ded9e.csv", "a1399549fc.csv", "3d9c85ca09.csv", "1fcb7d3202.csv", "efee705915.csv", "3ce3166da6.csv", "37bf6fa697.csv", "4d4a661559.csv", "e543bf0ae5.csv", "f8ab46b238.csv", "a891f13d87.csv", "801a6b85e9.csv", "a70e6f7198.csv", "a7d8bd09f2.csv", "185ba8d97e.csv", "c6341abea4.csv", "5fd56833e8.csv", "bf1ddcc0ee.csv", "5ea960f32b.csv", "0b471647fc.csv", "dcf53e4866.csv", "2c51f33edf.csv", "20d279c592.csv", "54754276cd.csv", "bee8cc85f2.csv", "8e555d6f11.csv", "d567c5cd83.csv", "fee8f23324.csv", "db1c3a6f41.csv", "a0ec9636b1.csv", "e1cae49c22.csv", "59c8c92c4f.csv", "6a81223b52.csv", "97fbe90e76.csv", "36ba20b126.csv", "ddc646aac4.csv", "f88ab32742.csv", "2661813c3b.csv", "bb44cd6000.csv", "54874866b6.csv", "141e9a4d25.csv", "3d2f6ae8ca.csv", "f0b58ef943.csv", "29fd964d25.csv", "a9cc09e005.csv", "ded47c1ac2.csv", "ba1e9a8100.csv", "8011641884.csv", "374b325c68.csv", "e3794bad55.csv", "a3f209a6f1.csv", "ca232cf069.csv", "419f4e3e2b.csv", "7dcab89c88.csv", "17825be60e.csv", "08966bf7d8.csv", "45ece9ad44.csv", "022bfdae64.csv", "b2d402999f.csv", "51a7d0f8d3.csv", "16f7839cd3.csv", "033748e5ce.csv", "614bc6a90e.csv", "1d80bff330.csv", "b8a46ad7bc.csv", "43e79e7326.csv", "fa36f3929d.csv", "7d47576f72.csv", "cf70799c98.csv", "e7ad72e00c.csv", "1cf41dcf42.csv", "1a84955616.csv", "fe00c77bb9.csv", "feb82581e0.csv", "f7ac9b7eb6.csv", "31096b47dd.csv", "b78e86ca84.csv", "e44f5b436e.csv", "d462c766d7.csv", "dadbe75539.csv", "3980320410.csv", "db6a40cec4.csv", "bb267d8067.csv", "e3c163b05e.csv", "dac7b32540.csv", "e26f1af928.csv", "a0690053b2.csv", "e7ef6a8af0.csv", "32cd349275.csv", "1910eee72a.csv", "27c4f466d2.csv", "31c81497a8.csv", "970a8ed957.csv", "707a573d7c.csv", "0f3e68a0e9.csv", "908cb2197b.csv", "9d8f0e4fc2.csv", "34d00ce19d.csv", "63bcb048f8.csv", "fec8bd30a5.csv", "2720da91ce.csv", "7fb53b4b18.csv", "31aacee83e.csv", "78ae8d8f4d.csv", "3b7d8f8942.csv", "4de8682ef1.csv", "b8a9a5b32c.csv", "5eaec6bd8d.csv", "abd1098207.csv", "ceed6a5cfb.csv", "7abc80f697.csv", "1a40019b54.csv", "63737dac7c.csv", "b20317b704.csv", "f7d5618704.csv", "1b4de9c1c4.csv", "0e24e311c4.csv", "73bebe17a2.csv", "9b930fe522.csv", "3987bbaab7.csv", "ab00fcd42b.csv", "920198d131.csv", "5efe447b09.csv", "db3e3e7a5d.csv", "0e498d8806.csv", "f9a5abb217.csv", "942b0a62bc.csv", "156894b98f.csv", "cbb430ad17.csv", "4b41c315d1.csv", "5bf63b5c1b.csv", "66e5600489.csv", "a85bd7a449.csv", "26a942d43b.csv", "664556000a.csv", "48d5ce2570.csv", "f53152bfb0.csv", "72af5f873c.csv", "5f1d4e0011.csv", "a374d51e28.csv", "dee19b67f6.csv", "19287d949d.csv", "23cc61e988.csv", "109422b446.csv", "3105492562.csv", "ae140db505.csv", "a9cfd6b7bd.csv", "dad5dabc5e.csv", "933217c79c.csv", "3a562861e8.csv", "00d115455c.csv", "3f22dea998.csv", "8b06090ca4.csv", "cbe08d8e57.csv", "325ea9539f.csv", "6bff6ce697.csv", "c382d2499f.csv", "6d9d3c0585.csv", "c9bc2cb6f4.csv", "d7a8e3f09c.csv", "8f48042eb8.csv", "243c4bc8b3.csv", "db6c7891f2.csv", "ea5281ad23.csv", "ae86cd0749.csv", "6d2a813370.csv", "38e1393247.csv", "750d1188f5.csv", "15a4052f2b.csv", "54d99e1b9a.csv", "40402183cb.csv", "edc716bad5.csv", "182db85ba7.csv", "2db8aeef44.csv", "11dd078d05.csv", "c5cbb20d9b.csv", "2b4c3f1301.csv", "5f49fccc19.csv", "6c667380fb.csv", "d08836caa3.csv", "7f637d8a40.csv", "18cd899e8c.csv", "73364cb7fb.csv", "c2e7914cb3.csv", "feaf6de1b0.csv", "695157d9b3.csv", "49104035f5.csv", "11041507da.csv", "cb7eca9431.csv", "d21c5dccad.csv", "d7754e9891.csv", "b4da05e7a0.csv", "f8bd835960.csv", "c124a9dcf8.csv", "3570d01fe7.csv", "2e847a70fc.csv", "51f3695d3b.csv", "fb5b3574f4.csv", "3e346e32af.csv", "ea7f99b908.csv", "a31bb7cea8.csv", "279a54b54f.csv", "27a35aaa88.csv", "4e83ba00ce.csv", "cfcc4089bb.csv", "a255ab50b8.csv", "2a030d3d45.csv", "055e6bce96.csv", "29e3c85e3d.csv", "11c8da55ca.csv", "b155d187b2.csv", "1824b38c85.csv", "4132dc36b0.csv", "eda74b2e9d.csv", "faa0d07534.csv", "dc6f916fdf.csv", "9336f05d5e.csv", "fa57d14b41.csv", "d421ebe408.csv", "ba5772ce19.csv", "bb5ed0d249.csv", "a296e3bfb4.csv", "ae8d6f0ff0.csv", "c34f1c2b5a.csv", "aed42e4a87.csv", "ff55e8b170.csv", "88ca25e222.csv", "0508849dcb.csv", "2eb518586f.csv", "53a76f87e8.csv", "c2e07aaa22.csv", "e071283192.csv", "11141763ab.csv", "d54d820e96.csv", "16e7116154.csv", "0576ddf05d.csv", "2d64a61d8b.csv", "ac6871afbf.csv", "5c54cdf349.csv", "c657726134.csv", "7fe1642d17.csv", "91eb632d2c.csv", "dd47a02152.csv", "9f6ce7f041.csv", "7479790f34.csv", "4ccd9e2030.csv", "a3f9afe6a3.csv", "f2565aeb98.csv", "ca4e0ddfe6.csv", "ee5d4ebf00.csv", "5c3aacfe5a.csv", "1d6f168f5c.csv", "08dc4d5590.csv", "5eddb4c1dd.csv", "e97d5e9906.csv", "788d7ab1f6.csv", "e8dc8519de.csv", "1bffe2fcc2.csv", "2c07177298.csv", "e4119ed4da.csv", "002b987e0e.csv", "fe8e8df1f6.csv", "d277605e04.csv", "79713f1df3.csv", "36b42b323d.csv", "6a36603563.csv", "7416608758.csv", "c46b966c9b.csv", "c0a2e57b26.csv", "1d56c3efa4.csv", "5b0fdc2526.csv", "ec8b755183.csv", "f41f8979dd.csv", "f38262c349.csv", "f777ef16bf.csv", "342bd6eea7.csv", "00515ef6e8.csv", "0ad286a666.csv", "85b885c9c4.csv", "375feb6ddb.csv", "aa1b41b208.csv", "f3c5262afa.csv", "22ac5892df.csv", "44345c0ec9.csv", "cc46406260.csv", "10405996cc.csv", "12009ebe7f.csv", "fbbbe3ae72.csv", "cf2adbb8c7.csv", "772f39b930.csv", "9bad295c2f.csv", "21ab3bef6f.csv", "8b9d6283bf.csv", "a46d8a3fc9.csv", "ade63f642c.csv", "105a6b1903.csv", "80d4cc708b.csv", "c76d4fdaca.csv", "5b6b3df1d7.csv", "e0f124dd49.csv", "38385bc46b.csv", "9cf43b0f8b.csv", "b649caa8e2.csv", "c0771dfce6.csv", "42ccc4667a.csv", "c3be3365f7.csv", "30b4916fc2.csv", "5ec74f9b05.csv", "845c262c66.csv", "975987aec1.csv", "2b8bb6d43a.csv", "880ced8349.csv", "c8a5f913da.csv", "0b624cefd0.csv", "ce763043de.csv", "d95937169e.csv", "9874fd1603.csv", "17786271e1.csv", "c8d8cb3cd7.csv", "fab11dc966.csv", "81063b0ad8.csv", "34d230ee29.csv", "2bfba1b691.csv", "d907b76488.csv", "e77ea66915.csv", "07ba006e21.csv", "0b9415b913.csv", "8e32a983ba.csv", "417bf33678.csv", "517aa351f6.csv", "fce7e6b889.csv", "fc7cb6479e.csv", "f8523c0bf5.csv", "86dff5d3c3.csv", "e8e74ee066.csv", "676f9f4174.csv", "d2ecdc924e.csv", "2c9c40dd0a.csv", "b6cb63d9ec.csv", "5bc94729e1.csv", "176aeb7d1e.csv", "2ff4bea6b7.csv", "e28f76bf6f.csv", "d3abdeaed7.csv", "b23f69f553.csv", "f8c9f15bcd.csv", "f1faf34abd.csv", "5fbac884ca.csv", "a7fc110a23.csv", "48a8fe64d2.csv", "b6ec122b70.csv", "b4d3d436d0.csv", "136ad9c8e1.csv", "310bc64fb5.csv", "d7f099f2ca.csv", "19855330ee.csv", "fa68623142.csv", "af2806566c.csv", "ecfb178de1.csv", "e2fbed553e.csv", "e94c46cbe2.csv", "e7c401385b.csv", "4e75bb0427.csv", "ef11b42c33.csv", "20fadf6373.csv", "26b0f0c366.csv", "8233498975.csv", "fabd136b5d.csv", "9da5e2163d.csv", "c6196e3430.csv", "fb03115db2.csv", "1114134ca1.csv", "db036e182f.csv", "c97841c100.csv", "d38a0e89eb.csv", "7417846d27.csv", "f16f6ed533.csv", "0a504e722f.csv", "a077413f56.csv", "96734842e1.csv", "0655f141f2.csv", "8b02719418.csv", "e00408fca8.csv", "484ff423b6.csv", "a0dd506102.csv", "d5414f6a4f.csv", "05aa8915f2.csv", "171f9487ab.csv", "feaf1780f5.csv", "7ddfe0a69d.csv", "139cb78590.csv", "9fc9b5d615.csv", "d2f2341428.csv", "518fb39196.csv", "6c1c3111c0.csv", "3f51f326bd.csv", "4be8085e5b.csv", "d87c44015d.csv", "dc3265ec84.csv", "eafe9b03c3.csv", "7d6c79a6c1.csv", "e9015d27ba.csv", "f8761b701b.csv", "8d30651a8c.csv", "b13e1b59ab.csv", "ad9547c6d3.csv", "01f039ce6c.csv", "7b18610b34.csv", "32977d99f1.csv", "8172585383.csv", "6d8af25822.csv", "1bda2a5e83.csv", "b75749f2c3.csv", "d6bd92be8b.csv", "3654170686.csv", "50514291b5.csv", "52f84d35d9.csv", "6cb2721c9d.csv", "2e580e1584.csv", "41fc7e7bfe.csv", "de2c34c376.csv", "8d8ac6dd42.csv", "a204d343a1.csv", "41350b0f9c.csv", "10da88d1da.csv", "4506610042.csv", "625858e0fa.csv", "b53e921736.csv", "018508461a.csv", "d05ec33737.csv", "dc86fd261c.csv", "f806316cde.csv", "115426c44b.csv", "2c378ad717.csv", "10232dd336.csv", "029918cc9d.csv", "4c387776f4.csv", "77ddf5b010.csv", "483d7c621c.csv", "339b49b158.csv", "950c64b49a.csv", "4a60afcf59.csv", "ac93396602.csv", "fc0751325e.csv", "c8d4ba48ff.csv", "398e05438d.csv", "6e0e621041.csv", "9a4ca1b869.csv", "4f124270ac.csv", "d6bdff2069.csv", "d8adf56c7b.csv", "af9a150d7c.csv", "e3be7b1c4e.csv", "610bf7feed.csv", "651dac326a.csv", "66bd0b43a7.csv", "7d9a59aaff.csv", "db694ea4f5.csv", "88ace4b77c.csv", "5586520b08.csv", "79ae1bd58c.csv", "28e1e84255.csv", "6029865bb4.csv", "c8991dd905.csv", "ff39dcd145.csv", "4335f9313e.csv", "fb6ff69f3e.csv", "d2ab8a8f96.csv", "111e7187da.csv", "51f593d2f3.csv", "53735c3eef.csv", "ab3215e271.csv", "398f888312.csv", "528cbde754.csv", "ca7f502857.csv", "f8778a32ee.csv", "c470ed0a65.csv", "e8dd7ab6da.csv", "cc2975f67b.csv", "ed396694d0.csv", "fb43e3fd3c.csv", "bb6730b59c.csv", "06cd3e39dc.csv", "74b2a4dc17.csv", "654f1aee20.csv", "478279cac0.csv", "e81edc6775.csv", "1df49fb44c.csv", "6aca14326d.csv", "eed4756773.csv", "3bda087ae1.csv", "3629eab883.csv", "4cdd441ed5.csv", "951de05c36.csv", "d33f6b698e.csv", "75437037ef.csv", "0091e41519.csv", "721e1de395.csv", "4c481d4383.csv", "0d1f93e3c2.csv", "79d56fe1d4.csv", "7cfb157374.csv", "349489d732.csv", "a50b10b865.csv", "7ee6116dba.csv", "aadb0e98fe.csv", "af3ade14e9.csv", "5cf367f50b.csv", "265d7acfd9.csv", "21a4f853c0.csv", "d6cd465864.csv", "87f76d675b.csv", "833a5918cc.csv", "5f38736b3e.csv", "1f51051cfc.csv", "126b3f35fa.csv", "ef4f6312e8.csv", "61f53a6523.csv", "eabde041e3.csv", "0b92e8ac10.csv", "9c4ca061a8.csv", "328563994c.csv", "baae129009.csv", "41814743a1.csv", "c91bfcdf2d.csv", "5d24b1f8d2.csv", "9b2fc1d380.csv", "0dcd7b6905.csv", "e6fa1c423f.csv", "db3b763640.csv", "0f18edf8ea.csv", "e737799075.csv", "eacab07188.csv", "4acd607a76.csv", "7865e54bcd.csv", "6a482ef9e2.csv", "7c7cf92de8.csv", "86aa9d11f6.csv", "301b20575d.csv", "3aa9107e1a.csv", "b8a48601b3.csv", "1a66bf9cf2.csv", "3acd125bfd.csv", "4b8320d3da.csv", "fe3f681d0b.csv", "bc326ee101.csv", "ccdd56fd89.csv", "0cc16c2c6d.csv", "3196d079b0.csv", "d0a4566129.csv", "4c5050e572.csv", "0a2d849cd2.csv", "ec67035a42.csv", "07187a6479.csv", "9c1b1b74cc.csv", "0a91d87404.csv", "010edf8805.csv", "1c9cb70238.csv", "1b10f1f600.csv", "830baf55df.csv", "0b3746b0cb.csv", "36cd9b2f39.csv", "d3addfc2aa.csv", "3f4a4d3ed2.csv", "8e8cef6259.csv", "edf57c98c9.csv", "72400e8ae9.csv", "ddf4e263ae.csv", "007fd1ee28.csv", "3f77af6dbd.csv", "bbf60746fb.csv", "2d178cbda2.csv", "20cf623758.csv", "3a160d1a2d.csv", "a973f5cedb.csv", "a7849b1f37.csv", "e267f26fed.csv", "1e8b76d031.csv", "6c3fcb4d84.csv", "18ec2b109e.csv", "c9cfe06df1.csv", "386612022d.csv", "cb46063882.csv", "9fe2bd2aa2.csv", "4ecbced463.csv", "3bade31e1e.csv", "30f43968a1.csv", "e8cda228bd.csv", "e62b745563.csv", "c2a77a299c.csv", "0281705aec.csv", "7ae41d855a.csv", "c510553732.csv", "103bc6b8f2.csv", "3e1a054670.csv", "ec8f00cb00.csv", "9f3ebaa750.csv", "76428d3dd8.csv", "1d0b5b9859.csv", "167d5c17cc.csv", "33cecc12cd.csv", "ece1835742.csv", "14913a1880.csv", "b41ee19faa.csv", "5e18be2053.csv", "6d15c6a767.csv", "5deda8de9e.csv", "91d5af80b2.csv", "f8061c72a7.csv", "dd3348e2bf.csv", "5df1f0c64e.csv", "b17de76666.csv", "106143579b.csv", "a80989a462.csv", "ba21f2709d.csv", "0b06399990.csv", "ecfee6c155.csv", "563b7f41a3.csv", "68d3bcf71e.csv", "2478a6eac2.csv", "288eecca2e.csv", "967dc7a9cd.csv", "a1712997da.csv", "a784402b48.csv", "daca76964f.csv", "6cf8f2aacf.csv", "147f354870.csv", "9d07a69841.csv", "ff2c93008b.csv", "4e16af80df.csv", "c49566b3eb.csv", "746a5593e6.csv", "0e0906a3a3.csv", "da7891d195.csv", "d62df293f6.csv", "a42a6e65f6.csv", "8f319a61a7.csv", "442e5389ec.csv", "19e5289dd4.csv", "74a7363946.csv", "40f24277c8.csv", "b958edca21.csv", "f500cb0513.csv", "ece3f7c6e4.csv", "9f2388edd8.csv", "6504972337.csv", "16ed01b049.csv", "9f38c8aaab.csv", "8075154f06.csv", "0d271cbe9f.csv", "15c1111155.csv", "56c3ead95e.csv", "2a81a67d95.csv", "9ae3912577.csv", "651b90a50c.csv", "277ede6a90.csv", "ba2245df4f.csv", "062e20108b.csv", "fc45c3002a.csv", "faaf9bfe12.csv", "94235cf887.csv", "cfa936ecb2.csv", "91a4079dfd.csv", "2f64af9037.csv", "0fe9f9b6f1.csv", "05746f0ae5.csv", "08d3cdc606.csv", "98b214bb67.csv", "2a50fe4632.csv", "77dce0c078.csv", "4d1c6e57eb.csv", "61c4eebd64.csv", "87869154e9.csv", "3ae897ce86.csv", "fd629d26ab.csv", "b7ef508e41.csv", "d7d0d44ff2.csv", "6adb4fa662.csv", "6af918bf07.csv", "d2da3dd4f0.csv", "ace3e1db6a.csv", "451fb74860.csv", "306cf7f0d3.csv", "f9bd3a815b.csv", "b29d3be438.csv", "f60b579d37.csv", "70bab1ac40.csv", "a5b0abd0fa.csv", "6d4cc313ee.csv", "78112b5fdc.csv", "b9c9c9d9be.csv", "e4d497e98f.csv", "8c036de74b.csv", "4ef3954939.csv", "8a453c8e8f.csv", "59b0d703cc.csv", "f0f7d3733e.csv", "c82068758d.csv", "8d6b4268cc.csv", "ba42ee21ff.csv", "78848751b7.csv", "2a244ece77.csv", "2296d07474.csv", "1308936db2.csv", "aac8e0f780.csv", "a4343f3000.csv", "e71c1d12f2.csv", "63756b783d.csv", "dcfef48d62.csv", "64be1f9778.csv", "f08f4624a2.csv", "8f5442cf7f.csv", "f489323f43.csv", "5047343e1f.csv", "9d5ecafb8b.csv", "d33fc8b5af.csv", "9313d6312d.csv", "1ac46a8c71.csv", "ca2cbf1773.csv", "135bed9078.csv", "2efc70c997.csv", "2e3da1aade.csv", "cdceea53c2.csv", "325484491d.csv", "26635736a3.csv", "9fd12b2aa3.csv", "8cc8a889b4.csv", "6d15bdae51.csv", "12ac5b9c8c.csv", "8b7d0ad95d.csv", "d75bb2a8e7.csv", "f19b8ff9ac.csv", "b983165db7.csv", "a8ec671c17.csv", "251f0acb0b.csv", "3092e89f78.csv", "da56b56e94.csv", "cd5427c321.csv", "caedf0ad39.csv", "1a3582a3ff.csv", "1aff36c2e3.csv", "aba2cadf89.csv", "bd2fc27e90.csv", "464373629c.csv", "e002a74822.csv", "1f89528f39.csv", "06d9624195.csv", "8d1dc8875c.csv", "730ce6dfb0.csv", "98371daa06.csv", "91934c258c.csv", "563159c138.csv", "ebf56f0e01.csv", "0155e1e087.csv", "950842e561.csv", "d10bfa4599.csv", "3aea25fd54.csv", "ebd6fb0103.csv", "32d0a75e12.csv", "25ad4ca8b3.csv", "b2646fd48b.csv", "4bbd9f82cc.csv", "58b267413e.csv", "7d80fd33d6.csv", "d58b364fd6.csv", "e3f802a6c2.csv", "d364d7a828.csv", "bca71d8e48.csv", "6375a113b3.csv", "3016b2c49e.csv", "31e01bf1c7.csv", "02a6a5b1cf.csv", "2f4980f8aa.csv", "7db8edfe7c.csv", "1360136383.csv", "43b083815b.csv", "7ba7cc6925.csv", "67a9b29493.csv", "9929e3a231.csv", "2b39b219bb.csv", "6a2f71a640.csv", "761cc2edac.csv", "c150e3186b.csv", "81c491f9b0.csv", "657d5ee9ca.csv", "8df9efb223.csv", "28cb2eef22.csv", "34d0967286.csv", "ed7debafd9.csv", "27295db523.csv", "e59384a31d.csv", "e5765b0d4f.csv", "f4049bbaf5.csv", "c0fcb7402f.csv", "8e7fc30a8f.csv", "f0d9b275a4.csv", "8ff09b1c51.csv", "54d4c846e7.csv", "e8e1a53c9a.csv", "f97851b26a.csv", "3f3de21f0f.csv", "fe3a16b75f.csv", "8b2c3e1cae.csv", "938e6798d7.csv", "f6f8d08a0d.csv", "a95da3fae2.csv", "f09ec289ee.csv", "45fa9e215f.csv", "6ddb81ea7a.csv", "8485fcae1c.csv", "e789a7f915.csv", "c575b11a64.csv", "d3e7478ae6.csv", "e5bbab75a9.csv", "87037e4175.csv", "16d22bfcc1.csv", "043444229e.csv", "3a9a0a309b.csv", "44e4432801.csv", "9c56f8fef4.csv", "96e3297785.csv", "8852abebe9.csv", "8b588952f2.csv", "6b4fdc84dd.csv", "7cf340711d.csv", "ad0e3a88cb.csv", "a65c912cc4.csv", "025f8e2331.csv", "476f34adc0.csv", "77f7de2b42.csv", "cc94e10365.csv", "ebba4c38e5.csv", "40abae5545.csv", "cafd25fb46.csv", "8160fd66be.csv", "0a91ab4de1.csv", "7f2cb6024a.csv", "927d576046.csv", "32f207e2c7.csv", "b7ad593c1b.csv", "5f8571e94e.csv", "94d38d675a.csv", "cf0b9cc737.csv", "5c80424256.csv", "1b37803108.csv", "f101a1e237.csv", "b931597271.csv", "c4a4b80e1c.csv", "2c83e6077c.csv", "0a4312f60a.csv", "fa52c1263e.csv", "f062418dad.csv", "f677b44444.csv", "3c106ff511.csv", "086c49a424.csv", "e582a0f554.csv", "24c8ad541b.csv", "7ac09a7565.csv", "7643a09b2f.csv", "02e561c6a0.csv", "08003305ab.csv", "42b644833f.csv", "a1b32edd63.csv", "dc6f18cbb6.csv", "5760c70065.csv", "303e1bb1d0.csv", "076612cbfb.csv", "b2694b66b2.csv", "47f80eadb8.csv", "35b049e405.csv", "781d4dcd8b.csv", "e26783f2d8.csv", "be57d28b78.csv", "c68e9768b7.csv", "21d082cdca.csv", "0434da862a.csv", "60e3d3feb5.csv", "d8a5ca21da.csv", "f314b32d2b.csv", "c7cb917484.csv", "cc5aae67fc.csv", "8982966761.csv", "cd52dee303.csv", "8fb673c809.csv", "62091e2425.csv", "141e2169b2.csv", "e7cdc35a3f.csv", "4ffac904fa.csv", "f199ec5b4e.csv", "3822289485.csv", "64a95dbfcd.csv", "41d496a0af.csv", "6c8895b2fe.csv", "b9daddfe37.csv", "b7fa0e69ff.csv", "da90be2357.csv", "a92a00ce01.csv", "fbda4fb474.csv", "e482e085ea.csv", "ca1ee127b4.csv", "4b6f695f74.csv", "c5c242279d.csv", "e45cde7da0.csv", "8318038381.csv", "66d98053eb.csv", "631d98490c.csv", "d09d3582bf.csv", "2f1e4457ee.csv", "abdeb2f802.csv", "df41a50556.csv", "b02e1fac3c.csv", "370783d656.csv", "2713e7c7a2.csv", "e71c220e1a.csv", "45f8659fb6.csv", "8e7d663d12.csv", "967626b22b.csv", "2b6b47bbf2.csv", "d4deee7860.csv", "178feea29a.csv", "6de2313dc7.csv", "51fc893523.csv", "7c0f2567b4.csv", "2436bb0967.csv", "a653ba4478.csv", "db0124f143.csv", "31fc6d05a1.csv", "92dac1dde1.csv", "cc25482856.csv", "2c543393cb.csv", "7782fd0461.csv", "f17cdc5c02.csv", "8c40eb47f9.csv", "9b93987c65.csv", "746f21193d.csv", "b47d464c38.csv", "25317fae55.csv", "0519dcf665.csv", "b7667ab450.csv", "580a0c319f.csv", "eb42d58dcb.csv", "018766482d.csv", "862cdd4635.csv", "e6ef71f16f.csv", "4273eb73fc.csv", "c18ba9eaaf.csv", "1cf8bc601b.csv", "4af730d210.csv", "aac26fc221.csv", "061a796ec9.csv", "ba215e4b1d.csv", "976df66461.csv", "40301f1ab0.csv", "b035c09e5b.csv", "4d4d980abe.csv", "350fe781aa.csv", "160eef76e0.csv", "b15312a936.csv", "a503ece2ac.csv", "fa91724b14.csv", "336e0947cd.csv", "c4c332b844.csv", "068161bdc7.csv", "ad4303f26f.csv", "7200b7ed13.csv", "2bd5899809.csv", "860c3dbe8c.csv", "5c44ca2f84.csv", "f1800d174c.csv", "373b8f2885.csv", "7499f67fc4.csv", "c5ca6f89d2.csv", "c37fd67c1a.csv", "7a35dbccaf.csv", "9f4208be26.csv", "02d107e9b9.csv", "4f9d87d4ae.csv", "c65fbcd73f.csv", "d7254ffd13.csv", "ed1eb9a1b8.csv", "8ce8ad294e.csv", "b03c5079f0.csv", "9f57910a10.csv", "145967fb89.csv", "b52205961c.csv", "d76e77290c.csv", "99c01fb329.csv", "f97c8bc045.csv", "b6e32de6f4.csv", "584dd06992.csv", "6b199ea18a.csv", "7b0d210ab0.csv", "020773258f.csv", "a0086c9c2e.csv", "98942c3159.csv", "e837a72269.csv", "4ae73ab91f.csv", "fadd79f874.csv", "55c9831706.csv", "b461b70ee5.csv", "961c517aa4.csv", "c73b0e5015.csv", "50df6eeef5.csv", "c921ef713e.csv", "cb0b8ccd95.csv", "2381cac505.csv", "543b495942.csv", "4f5dda0c6f.csv", "da05724cb2.csv", "cf8033ed46.csv", "4482febd88.csv", "2689a859e1.csv", "acdd6616fc.csv", "1b3303c785.csv", "4195d3f102.csv", "1be4d25418.csv", "52268fe8f0.csv", "def341cb99.csv", "ddfa08d2bd.csv", "4c3c23ab3e.csv", "5a4071c3bc.csv", "4da55bad79.csv", "2e93bce08a.csv", "5cca3cc77c.csv", "cfa0ee73fa.csv", "f9230266b2.csv", "4014466524.csv", "17a390b532.csv", "67f5d8e0b7.csv", "81a8c4f946.csv", "fbafe89279.csv", "07ecd6f7a4.csv", "2f74fda3d9.csv", "3d5b94c493.csv", "716b2e55fc.csv", "6b179b627e.csv", "2e6f228a30.csv", "67ca66342c.csv", "b50ceba68c.csv", "611e01f91e.csv", "f8827e551e.csv", "091407d697.csv", "0787dded6f.csv", "bdab563646.csv", "1a0d448d6e.csv", "cb542efa27.csv", "18c08cffd2.csv", "686af8d152.csv", "fef53b00b2.csv", "f97db8d127.csv", "8fc6659c50.csv", "24a006326f.csv", "e275826dbd.csv", "842a4bbd1a.csv", "7682999751.csv", "e3f56d7414.csv", "c933d9f055.csv", "3683dadbee.csv", "9b0e8dd7c8.csv", "1ec33fea39.csv", "ba37b02a09.csv", "6dc192fa7e.csv", "a0940f8551.csv", "adf4379854.csv", "90cb30b087.csv", "5ac42fefa7.csv", "cf6370da30.csv", "d8021b9b2e.csv", "9e7d1bba6d.csv", "14654a938b.csv", "e6691f88ee.csv", "c9c772de1f.csv", "d931b7efd7.csv", "a9ebd02943.csv", "fd3d6197e2.csv", "fee94d4ea6.csv", "3bd0c997c8.csv", "9ad6395948.csv", "e998bdc86b.csv", "d87a9a2643.csv", "f2e54a1696.csv", "8568b8c20a.csv", "1174e605e6.csv", "9d34d748cd.csv", "6ba6e78ca0.csv", "c77b96228b.csv", "9ddef381e4.csv", "646e04882e.csv", "b92743733a.csv", "527bf6bafc.csv", "3ae3ca6d0a.csv", "f8d73b1e02.csv", "cd866cf642.csv", "f1a2213b09.csv", "41ca9e637a.csv", "6903adc956.csv", "4880e0484f.csv", "1f0d970cb5.csv", "921dcb2298.csv", "506e4d83da.csv", "e06c25f653.csv", "608f427c9b.csv", "b55e46b204.csv", "c1bfc1aeba.csv", "5def9df014.csv", "22c7efd546.csv", "3a334560eb.csv", "b0c4ca9556.csv", "92834e24e1.csv", "b972d43e4c.csv", "7b01d9e2ce.csv", "0c2f87abc7.csv", "b10def6f3a.csv", "ce40f6fdf3.csv", "6e7f451f3f.csv", "9330d2a13b.csv", "8c1ebfc884.csv", "9115413fde.csv", "0422e26770.csv", "e1ad6f70f8.csv", "77f586d0fc.csv", "01a99bfe48.csv", "3988564675.csv", "a355239d0f.csv", "714ad2b589.csv", "3f93ca33cc.csv", "ec8f147f26.csv", "e953fc82bc.csv", "f48b14442d.csv", "f21f9c68c8.csv", "cec9ef0dd6.csv", "0c774d4faf.csv", "c1bb75e3f7.csv", "011cbc9173.csv", "1f1042c788.csv", "308e70b1fc.csv", "df20fb7aa9.csv", "e8d512194a.csv", "e472cfb88d.csv", "473875a66d.csv", "effb2446dc.csv", "6cb5b5c803.csv", "b8e16b6a7f.csv", "706287763d.csv", "43d1bd43a5.csv", "9920ddfa36.csv", "773bcb86e4.csv", "47df63abaa.csv", "1dd41fc44a.csv", "27dc95f871.csv", "ccf448a5be.csv", "bad84ff4c8.csv", "62d4f11ea8.csv", "de721807e4.csv", "26279965a7.csv", "ba3843c6dc.csv", "a1b43df28f.csv", "f8e7890254.csv", "c17c6e6ac7.csv", "9b5f794033.csv", "c8f196a2c4.csv", "058502ca97.csv", "d22be6a690.csv", "35fbdb1f29.csv", "571aa1c870.csv", "98d13669a8.csv", "43fe577815.csv", "682fc4964b.csv", "c50ba7fbbe.csv", "cfd2002580.csv", "57961e974b.csv", "dedb1b9c96.csv", "7d9448bcb9.csv", "bb8a63e842.csv", "d43c891c25.csv", "76255ca669.csv", "187f2927f7.csv", "c4bab1ee87.csv", "8f908b79fa.csv", "9890e7908d.csv", "e28ddc58a8.csv", "44c1ca5631.csv", "adf2606693.csv", "e996afc872.csv", "5c40617cb2.csv", "d78853e25d.csv", "ec88e90f99.csv", "04afc9f2ef.csv", "8f20e283f5.csv", "738f1b6700.csv", "a77eb96a3b.csv", "ef4ec98628.csv", "1756294887.csv", "e75344389b.csv", "177e120413.csv", "f643d710f1.csv", "7c6ca29325.csv", "289b6a5fc9.csv"]
def file_less_than_3mb(file_path):
    try:
        file_size = os.path.getsize(file_path)  # Get file size in bytes
        return file_size < 5 * 1024 * 1024  # 1 MB in bytes
    except FileNotFoundError:
        print("File not found.")
        return False

def process_file(full_path, filename):
    print("RUNNING ", filename, "\n")
    profile, file_path, candidates_with_indices = create_profile(full_path)
    data = run_voting_methods(profile, file_path, candidates_with_indices)
    all_data.append(data)
    print(data, "\n")

    with open(data_file, mode='a', newline='') as file:
        writer = csv.writer(file)
        keys = all_data[0].keys()
        row = [data.get(key, '') for key in keys]
        writer.writerow(row)

    with open(processed_file, "a") as ef:
        ef.write(f"{filename}, ")

def read_processed():
    
    processed_files = []

    with open(error_file, 'r') as file:
        content = file.read()
        processed_files += [file.strip() for file in content.split(',')]

    with open(processed_file, 'r') as file:
        content = file.read()
        processed_files += [file.strip() for file in content.split(',')]

    return processed_files

# processed_files = read_processed()
# print(processed_files)

def main():
    for dirpath, dirnames, filenames in os.walk(root_dir):
        for filename in filenames:
            print(filename)
            if filename.endswith('.blt') or filename.endswith('.csv') or filename.endswith('.txt'):
                if filename not in processed:
                    full_path = os.path.join(dirpath, filename)
                    if __name__ == '__main__':
                        p = multiprocessing.Process(target=process_file, args=(full_path,filename))
                        p.start()
                        p.join(10)

                        if p.is_alive():
                            print("running... let's kill it...")
                            with open(error_file, "a") as ef:
                                ef.write(f"{filename}, ")
                            p.terminate()
                            p.join()
                            print("\n")
                else:
                    print("already processed")
if __name__ == '__main__':
    main()
            